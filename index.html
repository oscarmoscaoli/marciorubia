<section id="faq" class="py-24 bg-[#070b14]">
    <div class="container mx-auto px-6">
        <h2 class="text-3xl font-bold text-white uppercase mb-12 text-center tracking-tighter">Dúvidas Frequentes</h2>
        <div id="planilha-faq" class="max-w-3xl mx-auto space-y-4">
            <p class="text-gray-500 text-center">Carregando perguntas...</p>
        </div>
    </div>
</section>

<section id="contato" class="py-24 border-t border-gray-900">
    <div class="container mx-auto px-6 max-w-4xl">
        <div class="bg-[#161e2d] p-10 rounded-xl border border-gray-800 shadow-2xl">
            <h2 class="text-3xl font-bold text-white mb-6 uppercase text-center">Fale com Especialista</h2>
            <form id="mainContactForm" class="grid md:grid-cols-2 gap-6">
                <input type="hidden" name="origem" value="SITE_PRINCIPAL">
                <div class="space-y-4">
                    <input type="text" name="nome" placeholder="Seu Nome" required class="w-full bg-[#0a0f1d] border border-gray-800 p-4 rounded outline-none focus:border-red-600 transition">
                    <input type="tel" name="whatsapp" id="whatsappMain" placeholder="Seu WhatsApp" required class="w-full bg-[#0a0f1d] border border-gray-800 p-4 rounded outline-none focus:border-red-600 transition">
                    <input type="text" name="assunto" placeholder="Assunto (Ex: Aposentadoria)" class="w-full bg-[#0a0f1d] border border-gray-800 p-4 rounded outline-none focus:border-red-600 transition">
                </div>
                <div class="space-y-4">
                    <textarea name="mensagem" placeholder="Como podemos ajudar?" class="w-full bg-[#0a0f1d] border border-gray-800 p-4 rounded h-full min-h-[150px] outline-none focus:border-red-600 transition"></textarea>
                </div>
                <button type="submit" id="btnMainEnviar" class="md:col-span-2 bg-[#5e111a] text-white py-5 rounded font-bold uppercase tracking-widest hover:bg-red-900 transition shadow-lg">Enviar Mensagem e Gravar na Planilha</button>
            </form>
            <div id="mainMsgSucesso" class="hidden bg-green-900/30 text-green-400 p-4 rounded text-center font-bold mt-4 border border-green-800">Mensagem enviada com sucesso!</div>
        </div>
    </div>
</section>

<script>
    // Carregar FAQ da Planilha
    const linkFAQ = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTGTmFKa5sWYwZhGQdNtmv0UOA21ysvay_DGKbWyweedlgQtHSCe1pVMEN49s2grywXisQR4iJl8Q_N/pub?gid=1113524673&single=true&output=csv';
    
    async function loadFAQ() {
        try {
            const res = await fetch(linkFAQ);
            const data = await res.text();
            const container = document.getElementById('planilha-faq');
            const rows = data.split(/\r?\n/).slice(1);
            container.innerHTML = rows.map(r => {
                const c = r.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);
                if (c && c.length >= 2) {
                    return `
                        <details class="bg-[#161e2d] border border-gray-800 rounded p-4 group cursor-pointer hover:border-red-900 transition">
                            <summary class="text-white font-bold uppercase text-sm list-none flex justify-between">
                                ${c[0].replace(/^"|"$/g, '')}
                                <span class="text-red-600 group-open:rotate-180 transition">+</span>
                            </summary>
                            <p class="text-gray-400 text-sm mt-4 leading-relaxed">${c[1].replace(/^"|"$/g, '')}</p>
                        </details>`;
                } return '';
            }).join('');
        } catch (e) { console.error("Erro no FAQ", e); }
    }
    loadFAQ();

    // Lógica do Formulário de Contato Principal
    const mainForm = document.getElementById('mainContactForm');
    const scriptURL = 'SUA_URL_DO_APPS_SCRIPT_AQUI'; // Insira sua URL de deploy aqui

    mainForm.addEventListener('submit', e => {
        e.preventDefault();
        const btn = document.getElementById('btnMainEnviar');
        btn.innerText = "GRAVANDO NA PLANILHA...";
        btn.disabled = true;

        fetch(scriptURL, { method: 'POST', body: new FormData(mainForm)})
            .then(() => {
                mainForm.reset();
                btn.classList.add('hidden');
                document.getElementById('mainMsgSucesso').classList.remove('hidden');
            });
    });
</script>
